<%= stylesheet_link_tag "charges", :media => "all" %>
<%= javascript_include_tag "charges" %>

<%= form_for(@charge) do |f| %>
  <% if charge.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(charge.errors.count, "error") %> prohibited this charge from being saved:</h2>

      <ul>
      <% charge.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
<div class="container">
  <div class="col-md-12 col-xs-3">
    <div class="text-center">


  <div class="field">
    <%= f.hidden_field :order_id, value: @order.id %>
  </div>

<% if @order.pay_type == "Card" %>
          <%= form_tag charges_path do %>
            <article>
              <% if flash[:error].present? %>
                <div id="error_explanation">
                  <p><%= flash[:error] %></p>
                </div>
              <% end %>
              <label class="amount">
                <span class="cardPayFont">Amount: <%= number_to_currency(@cart.total_price) %></span>
              </label>
            </article>
            <hr>
            <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                    data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
                    data-description="<%= current_user.name %>"
                    data-amount="<%= number_to_currency(@cart.total_price) %>"
                    data-email="<%= current_user.email %>"
                    data-label="Pay <%= number_to_currency(@cart.total_price) %>"
                    data-locale="auto"></script>
          <% end %>
      </div>
    <% elsif @order.pay_type == "Cash" %>
    <% end %>
  </div>

<hr>

<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
  <div class="actions">
    <div class="text-center">
      <hr>
      <div class="orderNotice">Please wait while your order is processed.</div>
      <hr>
      <%= f.submit("Create Order", {class: "buttonForm buttonGForm submitOrder"}) %>
    </div>
  </div>
</div>
<% end %>

 </div>
